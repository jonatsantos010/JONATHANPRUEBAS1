<div class="container soat-container">
  <div *ngIf="successfullPayment">
    <div class="soat-header">
      <h2 class="title">El proceso de su compra ya fue finalizado.</h2>
    </div>
    <div class="row justify-content-center">
      <div class="col soat-text-align-center space">
        <button class="soat-button ripple stretch"
                (click)="goToMain()">
          <i class="fa fa-circle-o-notch fa-spin"
             *ngIf="loading"></i>
          Realizar otra Compra
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="loading && !successfullPayment">
    <div class="soat-header">
      <h2 class="title">
        <div class="container-pago">
          <img src="assets/soat/img/tarjeta.svg"
               alt=""
               srcset="" />
          <h5 class="loader-titulo">Por favor, espere unos segundos</h5>
          <h6 class="loader-sutitulo">Estamos procesando su pago</h6>
          <div class="loader-pago">
            <div class="loaderBar-pago"></div>
          </div>
        </div>
      </h2>
    </div>
  </div>

  <div *ngIf="!loading && !successfullCall && !successfullPayment && errorFnCb">
    <div class="soat-header">
      <h2 class="title">
        Lamentablemente tu pago no se realizó satisfactoriamente
      </h2>
    </div>
    <p>
      Estimado cliente, ha ocurrido un error al intentar comunicarnos con la
      entidad financiera que seleccionaste, vuelve a intentar nuevamente por
      favor
    </p>
    <div class="row justify-content-center">
      <div class="col soat-text-align-center space">
        <button class="soat-button ripple stretch"
                routerLink="/shop/checkout">
          <i class="fa fa-circle-o-notch fa-spin"
             *ngIf="loading"></i>
          Volver a Intentar
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="
      !loading && !approve && valid && !successfullPayment && successfullCall
    ">
    <div class="soat-header">
      <h2 class="title">Pedido Recibido</h2>
    </div>
    <p>
      Desgraciadamente, tu pedido no puede procesarse; el banco/comercio ha
      rechazado tu transacción. Por favor, intenta realizar la compra de nuevo.
    </p>

    <div class="box-pay-info row">
      <div class="col-sm-3">
        <b>N&Uacute;MERO DE PEDIDO:</b>
        <br />
        <span>{{ auth?.orderNumber }}</span>
      </div>
      <div class="col-sm-3">
        <b>FECHA:</b>
        <br />
        <span>{{ auth?.transactionDateTime }}</span>
      </div>
      <div class="col-sm-6">
        <b>MOTIVO RECHAZO:</b>
        <br />
        <span>{{ auth?.errorMessage }}</span>
      </div>
    </div>
    <div class="link-container">
      <a class="link-terminos"
         (click)="showTermsAndConditions()">
        Nuestros t&eacute;rminos y condiciones
      </a>
    </div>
    <div class="row justify-content-center">
      <!-- <div class="col-6 soat-text-align-center">
        <button type="button"
                class="btn-print"
                (click)="downloadPdf()">
          <i class="fa fa-print print-color"></i>
          <span>Imprimir Reporte</span>
        </button>
      </div> -->
      <div class="col soat-text-align-center">
        <button class="soat-button ripple"
                routerLink="/shop/checkout">
          <i class="fa fa-circle-o-notch fa-spin"
             *ngIf="loading"></i>
          Volver a Intentar
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="!loading && approve && valid && !successfullPayment">
    <div class="soat-header">
      <h2 class="title">
        Completaste la compra de tus seguros Protecta Security
      </h2>
    </div>
    <p>
      Gracias por confiar lo que más valoras en Protecta Security.<br>Le llegará una notificación vía correo
      electrónico.
      <!--<b>{{ vidaleyUser?.email }}.</b>-->
    </p>

    <div class="box-pay-info row">
      <div class="col-sm-3">
        <b>N&Uacute;MERO DE PEDIDO:</b>
        <br />
        <span>{{ auth?.orderNumber }}</span>
      </div>
      <div class="col-sm-3">
        <b>FECHA:</b>
        <br />
        <span>{{ auth?.transactionDateTime }}</span>
      </div>
      <div class="col-sm-3">
        <b>TOTAL:</b>
        <br />
        <span>S/ {{ auth?.authorizedAmount }}</span>
      </div>
      <div class="col-sm-3">
        <b>M&Eacute;TODO DE PAGO:</b>
        <br />
        <span>Visa</span>
      </div>
    </div>

    <div class="box-detail">
      <!--<div>
        <b>Cliente:</b>
        <span>{{ auth?.customerName }}</span>
        <br />
      </div>-->
      <div>
        <b>Fecha:</b>
        <span>{{ auth?.fullDate }}</span>
        <br />
      </div>
      <div>
        <b>Nro. de tarjeta:</b>
        <span>{{ auth?.cardNumber }}</span>
        <br />
      </div>
      <!--<div>
        <b>Poliza:</b>
        <span>{{ auth?.numPolicy }}</span>
        <br />
      </div>-->
      <div>
        <b>Moneda:</b>
        <span>Soles</span>
        <br />
      </div>
      <div class="h-divider"></div>
      <h5>Detalles del pedido</h5>
      <div class="div-result">
        <table class="tb-result">
          <tr>
            <td class="tl">Producto</td>
            <td class="tr">Total</td>
          </tr>
          <tr>
            <td>Seguros Protecta Security</td>
            <td>S/ {{ auth?.authorizedAmount }}</td>
          </tr>
          <tr>
            <td>Subtotal:</td>
            <td>S/ {{ auth?.authorizedAmount }}</td>
          </tr>
          <tr>
            <td>M&eacute;todo de pago:</td>
            <td>Visa</td>
          </tr>
          <tr>
            <td>Total:</td>
            <td>S/ {{ auth?.authorizedAmount }}</td>
          </tr>
        </table>
      </div>
    </div>
    <div class="link-container"
         hidden>
      <a class="link-terminos"
         (click)="showTermsAndConditions()">
        Nuestros t&eacute;rminos y condiciones
      </a>
    </div>
    <div class="row justify-content-center">
      <!-- <div class="col-6 soat-text-align-center">
        <button type="button" class="btn-print" (click)="downloadPdf()">
          <i class="fa fa-print print-color"></i>
          <span>Imprimir Reporte</span>
        </button>
      </div> -->
      <div class="col soat-text-align-center mt-3">
        <button class="soat-button ripple"
                (click)="goToMain()">
          <i class="fa fa-circle-o-notch fa-spin"
             *ngIf="loading"></i>
          Realizar otra compra
        </button>
      </div>
    </div>
    <div class="h-divider"></div>
  </div>

  <div *ngIf="!loading && !valid && !successfullPayment && !errorFnCb">
    <div class="soat-header">
      <h2 class="title">
        No se realizó ningún cargo a la Tarjeta de Crédito. Lamentablemente, los
        valores ingresados para la emisión no cumplen con las validaciones
        necesarias:
      </h2>
    </div>
    <p *ngFor="let message of messages">- {{ message }}</p>
    <div class="row justify-content-center">
      <div class="col soat-text-align-center">
        <button class="soat-button ripple stretch"
                routerLink="/shop/checkout">
          <i class="fa fa-circle-o-notch fa-spin"
             *ngIf="loading"></i>
          Volver a Intentar
        </button>
      </div>
    </div>
  </div>

  <iframe [src]="pdf"
          frameborder="0"
          style="display: none"></iframe>
</div>

<ng-template #payment>
  <!-- <app-termsvidaley (closeaction)="closeTermsModal()"></app-termsvidaley> -->
</ng-template>
